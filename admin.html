<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Admin - Popular Banco Firebase</title>
  <link rel="stylesheet" href="styles.css"/>
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  <script src="firebase-config.js"></script>
</head>
<body>
  <header>
    <nav>
      <h2>üîß Painel Admin</h2>
    </nav>
  </header>
  <main style="padding:40px; max-width:800px; margin:0 auto;">
    <div class="card">
      <h1>Inicializar Banco de Dados Firebase</h1>
      <p>Este painel popula o Firestore com os dados iniciais de hospitais e bairros.</p>
      <button onclick="popularBanco()" class="btn-neon" style="margin:20px 0;">‚ñ∂ Popular Banco de Dados</button>
      <button onclick="limparBanco()" class="btn-neon" style="background:linear-gradient(90deg, #fc3169 0%, #ff6b6b 100%);">üóëÔ∏è Limpar Banco</button>
      <div id="log" style="margin-top:30px; font-family:monospace; font-size:0.9em;"></div>
    </div>
  </main>
  
  <script>
    async function popularBanco() {
      const log = document.getElementById('log');
      log.innerHTML = '<h3>‚è≥ Populando banco...</h3>';
      
      try {
        // HOSPITAIS
        const hospitais = [
          {nome: "Hospital das Cl√≠nicas", bairro: "Pinheiros", capacidade: 50, ocupados: 50},
          {nome: "UPA Vila Madalena", bairro: "Vila Madalena", capacidade: 20, ocupados: 20},
          {nome: "Hospital Universit√°rio USP", bairro: "Butant√£", capacidade: 60, ocupados: 45},
          {nome: "UPA Lapa", bairro: "Lapa", capacidade: 30, ocupados: 30},
          {nome: "Hospital S√£o Camilo", bairro: "Perdizes", capacidade: 40, ocupados: 39},
          {nome: "Santa Casa Barra Funda", bairro: "Barra Funda", capacidade: 35, ocupados: 35},
          {nome: "UPA Alto de Pinheiros", bairro: "Alto de Pinheiros", capacidade: 25, ocupados: 25},
          {nome: "Hospital Vila Penteado", bairro: "Vila Leopoldina", capacidade: 30, ocupados: 30},
          {nome: "UPA Jaguar√©", bairro: "Jaguar√©", capacidade: 20, ocupados: 18},
          {nome: "Hospital Leforte", bairro: "Vila S√¥nia", capacidade: 45, ocupados: 44},
          {nome: "Albert Einstein Morumbi", bairro: "Morumbi", capacidade: 50, ocupados: 50},
          {nome: "UPA Rio Pequeno", bairro: "Rio Pequeno", capacidade: 30, ocupados: 28},
          {nome: "S√£o Camilo Pomp√©ia", bairro: "Pomp√©ia", capacidade: 40, ocupados: 40},
          {nome: "S√≠rio-Liban√™s Jardins", bairro: "Jardim Paulista", capacidade: 60, ocupados: 60},
          {nome: "S√£o Luiz Itaim", bairro: "Itaim Bibi", capacidade: 55, ocupados: 55}
        ];

        for (const hospital of hospitais) {
          await db.collection('hospitais').add(hospital);
          log.innerHTML += `<p style="color:green;">‚úÖ ${hospital.nome}</p>`;
        }

        // BAIRROS
        const bairros = [
          {nome: "Pinheiros", adjacentes: ["Vila Madalena", "Butant√£", "Alto de Pinheiros", "Jardim Paulista"]},
          {nome: "Vila Madalena", adjacentes: ["Pinheiros", "Perdizes"]},
          {nome: "Butant√£", adjacentes: ["Pinheiros", "Jaguar√©", "Vila S√¥nia"]},
          {nome: "Lapa", adjacentes: ["Perdizes", "Barra Funda"]},
          {nome: "Perdizes", adjacentes: ["Vila Madalena", "Lapa", "Pomp√©ia"]},
          {nome: "Barra Funda", adjacentes: ["Lapa"]},
          {nome: "Alto de Pinheiros", adjacentes: ["Pinheiros"]},
          {nome: "Vila Leopoldina", adjacentes: ["Jaguar√©"]},
          {nome: "Jaguar√©", adjacentes: ["Butant√£", "Vila Leopoldina"]},
          {nome: "Vila S√¥nia", adjacentes: ["Butant√£", "Morumbi"]},
          {nome: "Morumbi", adjacentes: ["Vila S√¥nia", "Rio Pequeno"]},
          {nome: "Rio Pequeno", adjacentes: ["Morumbi"]},
          {nome: "Pomp√©ia", adjacentes: ["Perdizes"]},
          {nome: "Jardim Paulista", adjacentes: ["Pinheiros", "Itaim Bibi"]},
          {nome: "Itaim Bibi", adjacentes: ["Jardim Paulista"]}
        ];

        for (const bairro of bairros) {
          await db.collection('bairros').add(bairro);
          log.innerHTML += `<p style="color:blue;">‚úÖ Bairro: ${bairro.nome}</p>`;
        }

        log.innerHTML += '<h2 style="color:green;">‚úÖ Banco populado com sucesso!</h2>';
      } catch (error) {
        log.innerHTML += `<p style="color:red;">‚ùå Erro: ${error.message}</p>`;
      }
    }

    async function limparBanco() {
      if (!confirm('Tem certeza que deseja LIMPAR TODO o banco? Esta a√ß√£o n√£o pode ser desfeita!')) {
        return;
      }
      
      const log = document.getElementById('log');
      log.innerHTML = '<h3>‚è≥ Limpando banco...</h3>';
      
      try {
        // Deletar hospitais
        const hospitaisSnapshot = await db.collection('hospitais').get();
        for (const doc of hospitaisSnapshot.docs) {
          await doc.ref.delete();
          log.innerHTML += `<p style="color:orange;">üóëÔ∏è Hospital deletado</p>`;
        }
        
        // Deletar bairros
        const bairrosSnapshot = await db.collection('bairros').get();
        for (const doc of bairrosSnapshot.docs) {
          await doc.ref.delete();
          log.innerHTML += `<p style="color:orange;">üóëÔ∏è Bairro deletado</p>`;
        }
        
        // Deletar chamados
        const chamadosSnapshot = await db.collection('chamados').get();
        for (const doc of chamadosSnapshot.docs) {
          await doc.ref.delete();
          log.innerHTML += `<p style="color:orange;">üóëÔ∏è Chamado deletado</p>`;
        }
        
        log.innerHTML += '<h2 style="color:orange;">‚úÖ Banco limpo!</h2>';
      } catch (error) {
        log.innerHTML += `<p style="color:red;">‚ùå Erro: ${error.message}</p>`;
      }
    }
  </script>
</body>
</html>